\bigskip

\bigskip

Dla prostoty i przejrzystości sprawozdania wykorzystane zostały oznaczenia pierwotnie wprowadzone w skrypcie z przedmiotu STP.

\bigskip

Zadane wartości:

\smallskip

W1=W2=50\%

\smallskip

$\mathrm{G1_{pp}}=30$

\smallskip

$\mathrm{G2_{pp}}=35$

\smallskip

$T=4s$ (okres próbkowania)

\bigskip

Ograniczenia:

\smallskip

$0 \le \mathrm{G1}(k) \le 100$

$0 \le \mathrm{G2}(k) \le 100$

\chapter{Podpunkt 1}
Sprawdzenie możliwości sterowania i pomiaru w komunikacji ze stanowiskiem odbyło się po wgraniu początkowego kodu poprzez wysłanie do stanowiska kilku różnych wartości sterowania i zaobserwowanie odpowiedniej odpowiedzi stanowiska oraz zmian w napływających danych.

Pomiar wartości temperatur w punkcie pracy odbył się zgodnie z poleceniem poprzez zadanie wartości sygnałów W1, W2 oraz G1, G2, a następnie zarejestrowanie wartości sygnałów T1, T3 po ustabilizowaniu się układu. Otrzymane wartości to $\mathrm{T1_{pp}}=\num{36,5}$ oraz $\mathrm{T3_{pp}}=\num{38,3}$.

\begin{figure}[ht]
\centering
\input{./im/Z1T1}
\caption{Pomiar T1 w punkcie pracy}
\label{Z1T1}
\end{figure}

\begin{figure}[ht]
\centering
\input{./im/Z1T3}
\caption{Pomiar T3 w punkcie pracy}
\label{Z1T3}
\end{figure}

\chapter{Podpunkty 2 i 3}
Mechanizm zabezpieczający przed przekroczeniem pracy został zaimplementowany jako instrukacja warunkowa zerująca sygnał sterujący odpowiedniej grzałki w wypadku przekroczenia temperatury \SI{150}{\celsius}.

Regulator PID zaimplementowany został na sterowniku bez większych zmian w stosunku do formy zaprezentowanej w instrukcji i umieszczony grupie cyklicznych instrukcji ``Fixed Scan'', poniżej zamieszczono istotną część kodu jednego z regulatorów. Warto zauważyć, że mało estetycznie parametry są powtórzone w dwóch instrukcjach warunkowych, wynika to z tego, że parametry pierwotnie były lokalne i aby uniknąć długich zmian pierwsza instrukacja służy ich inicjalizacji. Druga instrukcja ułatwia zmianę wartości parametrów w czasie pracy sterownika. Całość kodu regulatora znajduje się w pliku \verb+PID3.gx3+.

\begin{lstlisting}
//Regulator PID na podstawie rownania roznicowego
IF NOT flag THEN
    Kp3 := 0.5;
    Ti3 := 45.0;
    Td3 := 2.0;
    Tp3 := 4.0;
    flag := TRUE;
END_IF;

IF (SD412 > 300) THEN
    Zadana_PID3 := 3650.0 + 200.0;
ELSE
    Zadana_PID3 := 3650.0;
END_IF;

SV_PID3 := Zadana_PID3;
PV_PID3 := INT_TO_REAL(D100);

//Wyliczenie parametrow
IF SM402 THEN
    Kp3 := 0.5;
    Ti3 := 45.0;
    Td3 := 2.0;
    Tp3 := 4.0;
END_IF;

R0_PID3 := Kp3*( 1.0+(Tp3/(2.0*Ti3))+Td3/Tp3 );
R1_PID3 := Kp3*( (Tp3/(2.0*Ti3))-(2.0*Td3/Tp3)-1.0);
R2_PID3 := Kp3*Td3/Tp3;

//Wyliczenie uchybu regulacji i przesuniecie historii
E2_PID3 := E1_PID3;
E1_PID3 := E0_PID3;
E0_PID3 := SV_PID3 - PV_PID3;

//Obliczenie sterowania
U_PID3 := R2_PID3*E2_PID3 + R1_PID3*E1_PID3 + R0_PID3*E0_PID3 + U_PID3;
//u = R2*E2 + R1*E1 + R0*E0 + u;

//Ograniczenia
IF (U_PID3 > 1000.0) THEN
    U_PID3:=1000.0;
END_IF;

IF (U_PID3 < 0.0) THEN
    U_PID3:=0.0;
END_IF;

//Zabezpieczenie
IF (PV_PID3 > 15000.0) THEN
    U_PID3:=0.0;
END_IF;

D114:=REAL_TO_INT(U_PID3);
\end{lstlisting}

Poniżej zamieszczono uzyskany z użyciem regulatora przebieg dla prostej trajektorii składającej się z dwóch skoków wartości zadanej.

// tu wykres


\chapter{Podpunkt 4}
Odpowiedzi skokowe procesu zbadane zostały dla skoku sygnału sterującego G1 o 20 z początkowej wartości 30 z pomiarem na T1 i T3. Na rys. \ref{Z2steps} zamieszczono wyznaczone odpowiedzi.

\begin{figure}[ht]
\centering
\input{im/Z2steps}
\caption{Odpowiedzi dla skoku sygnału sterującego G1 z punktu pracy o $\triangle U = 20$}
\label{Z2steps}
\end{figure}


\chapter{Podpunkt 5}
Wyświetlane na panelu wartości prezentowane są w prostej formie słupków z podanymi przy nich wartościami numerycznymi. Ponieważ element wyświetlający wartości numeryczne może także działać jako wejście umożliwiliśmy zadawanie w ten sposób wartości zadanej (uwaga - wymaga to wykomentowania ustawionej w kodzie trajektorii tak aby jedno nie kłóciło się z drugim). Poniżej zamieszczono zdjęcie panelu podczas pracy. Projekt panelu znajduje się w pliku \verb+simple_GOT.GTX+.

\begin{figure}[ht]
\centering
\input{im/6.jpg}
\caption{Zdjęcie panelu podczas pracy.}
\end{figure}

\chapter{Podpunkt 6}
Pracę nad automatem stanów rozpoczęto od podania wartości zadanych w instrukcjach warunkowych umożliwiając uzyskanie czterech stanów poprzez kombinacje niskich i wysokich wartości zadanych na każdym z wyjść. Niestety ze względu na ograniczenia czasowe po konsultacji z prowadzącym dostaliśmy polecenie przejścia do kolejnych podpunktów, stąd implementacja nie została dokończona.

\chapter{Podpunkt 7}
Zastosowana konfiguracja wymagała przede wszystkich włączenia czterech kanałów PWM --- Y0 to sygnał sterujący silnikiem ze stałą częstotliwością 10kHz, zaś kanały Y1-Y3 sterują zaworami. Niestety dla wypełnień sygnału pompy poniżej 40\% układ nie był w stanie pokonać grawitacji, przy wyższych wypełnieniach niestety zawory nie były w stanie opróżniać zbiorników szybciej niż te były wypełniane przez pompę. Stąd układ okazał się dużo bardziej problematyczny niż pierwotnie zakładano, w końcowej wersji zawory manualne zostały w pełni otwarte, a wypełnienie pompy ustawione na 60\%. Sterowanie odbywa się poprzez zmianę wypełnienia zaworów.

Poza kanałami PWM włączone zostały także trzy kanały ``High Speed I/O'' mieżące sygnał częstotliwościowy pomiaru wysokości cieczy w zbiornikach.

\begin{figure}[ht]
\centering
\input{im/Z5PID2}
\caption{Regulacja PID dla parametrów $K = 10 ~ T_\mathrm{i} = 45 ~ T_\mathrm{d} = \num{0.9}$. Błąd $E = \num{718.5}$.}
\label{R8}
\end{figure}

\begin{figure}[ht]
\centering
\input{im/Z5PID2}
\caption{Regulacja PID dla parametrów $K = 10 ~ T_\mathrm{i} = 45 ~ T_\mathrm{d} = \num{15}$. Błąd $E = \num{627.2}$.}
\label{R9}
\end{figure}
